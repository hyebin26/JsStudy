## 자바스크립트의 This

자바스크립트의 this는 함수를 선언할 때 정적으로 정해지는 것이 아니라 **함수를 호출하는 방식에 따라 동적으로 결정**된다.

> 함수의 상위 스코프를 결정하는 방식인 렉시컬 스코프는 함수를 선언할 때 결정된다. this바인딩과 헷갈리지 않도록 주의한다.
> 

자바스크립트의 this는 크게 세 가지로 나눠진다.

1. 함수호출
2. 메소드호출
3. 생성자 함수 

### 함수호출

전역객체는 모든 객체의 유일한 최상위 객체를 의미하며 일반적으로 브라우저에서는 window, 서버에서는 Global을 가르킨다.

- Global의 경우 Console, Module, process등이 있다.
- process: 노드 프로세스에 대한 정보가 담겨져 있다.

전역 함수의 경우 전역 스코프를 갖는 전역 변수를 프로퍼티로 소유하기 때문에, this는 window를 가르키게 된다.

그리고 전역함수의 내부함수, 매소드의 내부함수 등 모든 내부함수는 전역변수를 프로퍼티로 소유한다.

⇒ 설계상의 미스로, 모든 내부함수의 this는 전역객체를 가르킨다.

### 메소드 호출

함수가 객체의 프로퍼티 값이면 메소드로서 호출된다. 이때 메소드 내부의 this는 해당 메소드를 소유한 객체, 즉 해당 메소르르 호출한 객체에 바인딩된다.

### 생성자 함수

기존 함수에 new연산자를 붙여서 호출하면 해당 함수는 생성자 함수로 동작한다. 이때 new 연산자와 함께 생성자 함수를 호출하면 this바인딩이 메소드나 함수 호출 때와는 다르게 동작한다. new연산자와 함께 생성자 함수를 호출하면 다음과 같은 수순으로 동작한다.

1. 생성자 함수가 실행되기 전 빈객체 생성
2. 이후 생성자 함수 내에서 사용되는 this는 이 빈 객체를 가르킨다.
3. 생성된 빈 객체에 this를 사용하여 동적으로 프로퍼티나 메소드를 생성
4. 생성된 객체 반환 ⇒ 반환문이 없는 경우 this에 바인딩된 새로 생성한 객체가 반환, 하지만 this를 사용하지 않고 일반 객체를 만들어서 반환을 해줄 경우 생성자 함수로서의 역할을 수행하지 못한다.

⇒ 두 개의 차이는 프로토타입 객체인데, 객체를 반환할 경우 프로토타입 객체는 Object.prototype이 된다.

⇒ 생성자 함수의 경우 this가 다르기 때문에 다른 함수와 혼용되지 않기 위해 앞 글자를 대문자로 사용한다.
